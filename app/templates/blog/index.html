{% extends "base.html" %}

{% block title %}Blog Home{% endblock %}

{% block extra_css %}
<style>
    :root {
        --primary-brown-red: #8B4513; /* Saddle Brown - sophisticated earthy base */
        --secondary-sienna: #A0522D; /* Sienna accent for warmth */
        --light-cream: #FFF8DC; /* Light cream for readability */
        --deep-charcoal: #2C1810; /* Muted dark for text */
        --gold-accent: #DAA520; /* Golden highlight for elegance */
        --shadow-subtle: 0 4px 8px rgba(139, 69, 19, 0.1); /* Brown-tinted shadow */
    }

    body {
        background: linear-gradient(135deg, var(--primary-brown-red) 0%, var(--secondary-sienna) 50%, var(--light-cream) 100%);
        background-attachment: fixed;
        color: var(--deep-charcoal);
        font-family: 'Open Sans', sans-serif;
        line-height: 1.6;
        min-height: 100vh;
    }

    .container {
        background: rgba(255, 248, 220, 0.95); /* Semi-transparent cream overlay for contrast */
        border-radius: 12px;
        box-shadow: var(--shadow-subtle);
        margin-top: 20px;
        margin-bottom: 20px;
        padding: 2rem;
        backdrop-filter: blur(10px); /* Subtle blur for sophistication */
    }

    header h1 {
        font-family: 'Playfair Display', serif;
        color: var(--primary-brown-red);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        transition: transform 0.3s ease;
    }

    header h1:hover {
        transform: scale(1.02); /* Subtle interactive hover */
    }

    .post {
        background: white;
        border: 1px solid var(--light-cream);
        border-radius: 8px;
        overflow: hidden;
        transition: all 0.3s ease;
        position: relative;
    }

    .post:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-subtle);
        border-color: var(--secondary-sienna);
    }

    .post h2 a {
        color: var(--deep-charcoal);
        text-decoration: none;
        font-family: 'Playfair Display', serif;
        transition: color 0.3s ease;
    }

    .post h2 a:hover {
        color: var(--secondary-sienna);
    }

    .post img {
        transition: transform 0.3s ease;
    }

    .post img:hover {
        transform: scale(1.05);
    }

    .btn-primary {
        background-color: var(--secondary-sienna);
        border-color: var(--secondary-sienna);
        transition: all 0.3s ease;
    }

    .btn-primary:hover {
        background-color: var(--primary-brown-red);
        border-color: var(--primary-brown-red);
        transform: translateY(-2px);
    }

    .pagination .page-link {
        color: var(--secondary-sienna);
        border-color: var(--light-cream);
    }

    .pagination .page-link:hover {
        background-color: var(--secondary-sienna);
        color: white;
    }

    .form-control, .form-select {
        border-color: var(--light-cream);
        transition: border-color 0.3s ease;
    }

    .form-control:focus, .form-select:focus {
        border-color: var(--secondary-sienna);
        box-shadow: 0 0 0 0.2rem rgba(160, 82, 45, 0.25);
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        .container {
            margin: 10px;
            padding: 1rem;
        }
    }
</style>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container">
    <header class="mb-4 text-center">
        <h1 class="display-4">My Blog</h1>
        <nav class="mt-3">
            <a href="{{ url_for('blog.index') }}" class="btn btn-link text-decoration-none">Home</a>
            <!-- Add other nav links if needed -->
        </nav>
    </header>

    <!-- Search and Category Filter Form -->
    <form method="GET" class="mb-4">
        <div class="row g-3">
            <div class="col-md-5">
                <input type="text" name="q" class="form-control" placeholder="Search posts..." value="{{ q or '' }}">
            </div>
            <div class="col-md-5">
                <select name="cat" class="form-select">
                    <option value="">All Categories</option>
                    <!-- Pass categories from route to populate -->
                </select>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">Filter</button>
            </div>
        </div>
    </form>

    <main>
        {% if posts %}
            {% for post in posts %}
                <article class="post mb-4">
                    <div class="p-4">
                        <h2 class="h4 mb-2">
                            <a href="{{ url_for('blog.view_post', slug=post.slug) }}">{{ post.title }}</a>
                        </h2>
                        <p class="text-muted small mb-3">
                            By {{ post.author.username }} | {{ post.created_at.strftime('%b %d, %Y') }}
                            {% if post.views %} | {{ post.views }} views{% endif %}
                        </p>
                        {% if post.media_filename %}
                            <img src="{{ url_for('blog.media', filename=post.media_filename) }}" 
                                 alt="{{ post.title }}" 
                                 class="img-fluid mb-3 rounded">
                        {% endif %}
                        <p class="lead mb-3">{{ post.content[:200] }}{% if post.content|length > 200 %}...{% endif %}</p>
                        <a href="{{ url_for('blog.view_post', slug=post.slug) }}" class="btn btn-primary">Read more</a>
                    </div>
                    <hr class="m-0">
                </article>
            {% endfor %}

            <!-- Pagination -->
            {% if total_pages > 1 %}
                <nav aria-label="Post pagination" class="mt-4">
                    <ul class="pagination justify-content-center">
                        {% if has_prev %}
                            <li class="page-item">
                                <a class="page-link" href="{{ url_for('blog.index', page=page-1, q=q or '', cat=cat or '') }}">Previous</a>
                            </li>
                        {% endif %}
                        <li class="page-item active">
                            <span class="page-link">{{ page }} of {{ total_pages }}</span>
                        </li>
                        {% if has_next %}
                            <li class="page-item">
                                <a class="page-link" href="{{ url_for('blog.index', page=page+1, q=q or '', cat=cat or '') }}">Next</a>
                            </li>
                        {% endif %}
                    </ul>
                </nav>
            {% endif %}
        {% else %}
            <div class="text-center py-5">
                <h3 class="text-muted">No posts yet.</h3>
                {% if q or cat %}<p><a href="{{ url_for('blog.index') }}" class="btn btn-outline-secondary">Clear Filters</a></p>{% endif %}
            </div>
        {% endif %}
    </main>
</div>
{% endblock %}